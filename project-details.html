<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="The CodeGrammer - Project Details">
    <link rel="canonical" href="https://agency.thecodegrammer.net">
    <meta name="keywords" content="software,application,marketer,developer" />
    <meta property="og:title" content="Project Details - The CodeGrammer" />
    <meta property="og:image" content="/assets/images/app_config/agency.webp" />
    <meta property="og:site_name" content="The CodeGrammer" />
    
    <link rel="shortcut icon" href="/assets/images/app_config/favicon.webp" type="image/x-icon">
    <link rel="icon" href="/assets/images/app_config/favicon.webp" type="image/x-icon">

    <!-- CDNs for Stylesheets -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&family=Poppins:wght@400;500;600;700&family=Saira:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="stylesheet" href="/src/style.css" type="text/css">
    <link rel="stylesheet" href="/src/animations.css" type="text/css">

    <title>Project Details - The CodeGrammer</title>
</head>
<body>
    <header class="header-area position_top">
        <div class="site-logo">
            <div class="logo">
                <a href="/"><img src="/assets/images/app_config/logolight.webp" alt="logo"></a>
            </div>
        </div>
        <div class="main-menu">
            <nav class="main-nav">
                <div class="mobile-menu-logo">
                    <a href="/"><img src="/assets/images/app_config/logodark.webp" alt></a>
                    <div class="remove"><i class="bi bi-plus-lg"></i></div>
                </div>
                <ul>
                    <li class="has-child"><a href="/">Home</a></li>
                    <li class="has-child"><a href="/about-us/">About Us</a></li>
                    <li class="has-child"><a href="/services/">Services</a></li>
                    <li class="has-child active"><a href="/projects/">Projects</a></li>
                    <li class="has-child"><a href="/pricing/">Pricing</a></li>
                    <li class="has-child"><a href="/blogs/">Blogs</a></li>
                    <li class="has-child"><a href="/contact-us/">Contact Us</a></li>
                </ul>
            </nav>
        </div>
        <div class="nav-right">
             <!-- Mobile Menu logic matches other pages -->
             <div class="mobile-menu">
                <a href="javascript:void(0)" class="cross-btn">
                    <span class="cross-top"></span>
                    <span class="cross-middle"></span>
                    <span class="cross-bottom"></span>
                </a>
            </div>
        </div>
    </header>

    <main class="creasoft-wrap">
        <div class="line_wrap">
            <div class="line_item"></div><div class="line_item"></div><div class="line_item"></div><div class="line_item"></div><div class="line_item"></div>
        </div>

        <section class="breadcrumbs">
            <div class="container">
                <div class="row">
                    <div class="col-12">
                        <div class="breadcrumb-wrapper">
                            <div class="breadcrumb-cnt">
                                <h1 id="p-title-head">Loading...</h1>
                                <span><a href="/">Home</a><i class="bi bi-arrow-right"></i><a href="/projects/">Projects</a><i class="bi bi-arrow-right"></i><span id="breadcrumbs-title">...</span></span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="project-details sec-mar-top">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8">
                        <div class="project-details-content">
                            <h3 id="p-subtitle"></h3>
                            <div id="p-description"></div>
                            <div class="project-thumb mt-4">
                                <img id="p-image" src="" style="width:100%; border-radius:10px; display:none;" alt="project">
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4">
                        <div class="sidebar-widget">
                            <div class="client-box"><span>Category:</span><h5 id="p-category">-</h5></div>
                            <div class="client-box"><span>Client:</span><h5 id="p-client">-</h5></div>
                            <div class="client-box"><span>Company:</span><h5 id="p-company">-</h5></div>
                            <div class="client-box"><span>Duration:</span><h5 id="p-duration">-</h5></div>
                        </div>
                        <div class="sidebar-widget">
                            <div class="contact-info">
                                <h3>Need help?</h3>
                                <p>Please feel free to contact us.</p>
                                <div class="cmpy-info">
                                    <div class="icon"><i class="fas fa-phone-alt"></i></div>
                                    <div class="cnt"><h5>Phone</h5><a href="tel:88012454784">88012454784</a></div>
                                </div>
                                <div class="cmpy-info">
                                    <div class="icon"><i class="far fa-envelope"></i></div>
                                    <div class="cnt"><h5>Email</h5><a href="mailto:test@gmail.com">test@gmail.com</a></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="project-slider">
                        <h4>Other Projects</h4>
                        <div class="arrow">
                            <div class="swiper-button-next-c"><i class="bi bi-arrow-right"></i></div>
                            <div class="swiper-button-prev-c"><i class="bi bi-arrow-left"></i></div>
                        </div>
                        <div class="swiper project-slide">
                            <div class="swiper-wrapper" id="related-projects">
                                <!-- Dynamic -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <footer>
            <!-- Simplified footer for dynamic page -->
            <div class="container"><div class="footer-bottom"><p class="text-center text-white">Â© 2021 The CodeGrammer</p></div></div>
        </footer>

    </main>

    <div class="cursor"></div>
    <div id="progress"><span id="progress-value"><i class="fas fa-arrow-up"></i></span></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="/src/animations.js"></script>
    <script src="/src/custom.js"></script>
    <script type="module" src="/src/main.ts"></script>
    <script type="module">
        import { supabase } from '/src/supabase-client.js';

        async function loadProject() {
            const params = new URLSearchParams(window.location.search);
            const id = params.get('id');
            if(!id) {
                window.location.href = '/projects/';
                return;
            }

            // Fetch Main Project
            const { data: project, error } = await supabase
                .from('company_projects')
                .select('*')
                .eq('id', id)
                .single();

            if(error || !project) {
                document.querySelector('.project-details-content').innerHTML = '<p>Project not found.</p>';
                return;
            }

            // Update DOM
            document.title = `${project.title} - The CodeGrammer`;
            document.getElementById('p-title-head').textContent = project.title;
            document.getElementById('breadcrumbs-title').textContent = project.title;
            document.getElementById('p-subtitle').textContent = project.title;
            document.getElementById('p-description').innerHTML = project.description || '';
            
            if(project.image_url) {
                const img = document.getElementById('p-image');
                img.src = project.image_url;
                img.style.display = 'block';
            }

            document.getElementById('p-category').textContent = project.category || '-';
            document.getElementById('p-client').textContent = project.client || '-';
            document.getElementById('p-company').textContent = project.company || '-';
            document.getElementById('p-duration').textContent = project.duration || '-';

            // Fetch Related (Random 3)
            const { data: related } = await supabase
                .from('company_projects')
                .select('id, title, category, image_url')
                .neq('id', id)
                .limit(3);

            if(related && related.length > 0) {
                const relatedContainer = document.getElementById('related-projects');
                related.forEach(p => {
                    const div = document.createElement('div');
                    div.className = 'swiper-slide';
                    const img = p.image_url || '/assets/images/projects/project-1.webp';
                    div.innerHTML = `
                        <div class="single-item">
                            <div class="item-img"><a href="/project-details.html?id=${p.id}"><img src="${img}" alt="${p.title}" style="height:250px; object-fit:cover;"></a></div>
                            <div class="item-inner-cnt"><span>${p.category}</span><h4>${p.title}</h4><div class="view-btn"><a href="/project-details.html?id=${p.id}">view details</a></div></div>
                        </div>
                    `;
                    relatedContainer.appendChild(div);
                });
                
                // Init Swiper
                new Swiper('.project-slide', {
                    slidesPerView: 1,
                    spaceBetween: 30,
                    loop: true,
                    navigation: { nextEl: '.swiper-button-next-c', prevEl: '.swiper-button-prev-c' },
                    breakpoints: {
                        576: { slidesPerView: 2 },
                        992: { slidesPerView: 3 }
                    }
                });
            }
        }

        document.addEventListener('DOMContentLoaded', loadProject);
        
        // Mobile Menu
        $(document).ready(function() {
            $('.cross-btn').on('click', function() { $('.main-nav').toggleClass('slidenav'); });
            $('.remove').on('click', function() { $('.main-nav').removeClass('slidenav'); });
        });
    </script>
</body>
</html>
